#include <windows.h>
#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <sstream>
using namespace std;
bool clicking;
int xf1, xf2;
int yf1, yf2;

LRESULT CALLBACK WindowsProcedure(HWND, UINT, WPARAM, LPARAM);

void addMenus(HWND);
void addControls(HWND);
HMENU hMenu;
HWND hEdit;
HWND hStatic;


using namespace std;

int WINAPI WinMain(HINSTANCE hInst, HINSTANCE hPrevInst, LPSTR args, int ncmdshow){
 //Stealth();
 //MessageBox(NULL, "HELLO", "My first GUI", MB_OK);

//hInst - instancja aplikacji (ID nadawane przez system)

 WNDCLASSW wc = {0};
 wc.hbrBackground = (HBRUSH)COLOR_WINDOW;
 wc.hCursor = LoadCursor(NULL, IDC_ARROW);
 wc.hInstance = hInst;
 wc.lpszClassName = L"myWindowClass";
 wc.lpfnWndProc = WindowsProcedure;

 if (!RegisterClassW(&wc))
    return -1;

 CreateWindowW(L"myWindowClass", L"Clicker", WS_OVERLAPPEDWINDOW | WS_VISIBLE, 100, 100, 500, 500, NULL, NULL, NULL, NULL);

 MSG msg = {0};

 while(GetMessage((&msg), NULL, NULL, NULL ))
 {
    TranslateMessage(&msg);
    DispatchMessage(&msg);
 }
 return 0;
}

LRESULT CALLBACK WindowsProcedure(HWND hWnd, UINT msg, WPARAM wp, LPARAM lp){

    switch (msg)
    {
   case WM_CREATE:
        addMenus(hWnd);
        addControls(hWnd);
        break;
   case WM_COMMAND:
        switch (wp)
            {
            case 1:
                MessageBeep(MB_OK);
                MessageBox(NULL, "Clicker created by Krzysztof Gajewski", "Clicker v0.1", MB_OK);
                break;
            }
        break;

        case WM_KEYDOWN:
        {
            switch (wp)
            {
                case VK_F1:
                {
                    MessageBox(NULL, "Wcisnoles F1", "My first GUI", MB_OK);
                    Sleep(100);
                    POINT cursorPos;
                    GetCursorPos(&cursorPos);
                    //x = 0;
                    xf1 = cursorPos.x;
                    //y = 0;1
                    yf1 = cursorPos.y;


                    char *str = "Wspolrzedna X wynosi: ";


stringstream ss;
ss << "Wspolrzedna X wynosi: " << xf1 << "Wspolrzedna Y wynosi: " << yf1;
string s = ss.str();

	char cstr[s.size() + 1];
	strcpy(cstr, s.c_str());

                    MessageBox(NULL,cstr , "My first GUI", MB_OK);

                    SetWindowTextW(hEdit,L"TEST");
                    SetWindowTextW(hStatic,L"TEST");
                                   }
                break;

                case VK_F2:
                {
                    MessageBox(NULL, "Wcisnoles F2", "My first GUI", MB_OK);
                }
                break;
            }
        }
        break;

   case WM_DESTROY:
        PostQuitMessage(0);
        break;

   default:
        return DefWindowProcW(hWnd, msg, wp, lp);
    }
}

void addMenus(HWND hWnd)
{
    hMenu = CreateMenu();

    AppendMenu(hMenu, MF_STRING, 1, "About");
    SetMenu(hWnd,hMenu);

}


void addControls(HWND hWnd)
{
    hStatic = CreateWindowW(L"Static",L"Pierwszy punkt: ", WS_VISIBLE | WS_CHILD | SS_CENTER, 150,100,200,50,hWnd,NULL,NULL,NULL);
   hEdit = CreateWindowW(L"Edit",L"", WS_VISIBLE | WS_CHILD | SS_CENTER, 150,150,200,50,hWnd,NULL,NULL,NULL);

}


